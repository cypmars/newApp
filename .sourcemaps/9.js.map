{"version":3,"sources":["../../src/pages/chat2/chat2.module.ts","../../src/pages/chat2/chat2.ts"],"names":[],"mappings":"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","file":"9.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\nimport { Chat2Page } from './chat2';\r\nimport { TextToSpeech } from '@ionic-native/text-to-speech';\r\nimport { SpeechRecognition } from '@ionic-native/speech-recognition';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    Chat2Page,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(Chat2Page)\r\n  ],\r\n  exports: [\r\n    Chat2Page\r\n  ]\r\n})\r\nexport class Chat2PageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat2/chat2.module.ts","import { Component, ChangeDetectorRef } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ToastController, Platform, Content } from 'ionic-angular';\r\nimport { FormControl, FormBuilder } from '@angular/forms';\r\nimport { WelcomePage } from '../pages';\r\nimport { TextToSpeech } from '@ionic-native/text-to-speech';\r\nimport { SpeechRecognition, SpeechRecognitionListeningOptionsAndroid, SpeechRecognitionListeningOptionsIOS } from '@ionic-native/speech-recognition';\r\n/**\r\n * The Welcome Page is a splash page that quickly describes the app,\r\n * and then directs the user to create an account or log in.\r\n * If you'd like to immediately put the user onto a login/signup page,\r\n * we recommend not using the Welcome page.\r\n*/\r\n\r\ndeclare var ApiAIPlugin: any;\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-chat2',\r\n  templateUrl: 'chat2.html'\r\n})\r\n\r\nexport class Chat2Page {\r\n  \r\n  text: string;\r\n  speechList : Array<string> = [];\r\n  messages : Array<object> = [];\r\n  androidOptions: SpeechRecognitionListeningOptionsAndroid;\r\n  iosOptions: SpeechRecognitionListeningOptionsIOS;\r\n  textBody: string;\r\n  voiceBody: string;\r\n  alternate: boolean;\r\n  hideTime: boolean;\r\n  verbalResponse: boolean;\r\n  newMessage: {};\r\n  responseMessage: {};\r\n\r\n  constructor(private ref: ChangeDetectorRef, private speech: SpeechRecognition, private tts: TextToSpeech, public navCtrl: NavController, public platform: Platform) {\r\n      this.initializeApp()\r\n      this.hideTime = true;\r\n      this.verbalResponse = true;\r\n  }\r\n\r\n  initializeApp() {\r\n    this.platform.ready().then(() => {\r\n      if(!this.hasPermission()){\r\n        this.getPermission()\r\n      }\r\n    });\r\n  }\r\n\r\n  async SpeakText(voice):Promise<any> {\r\n    try{\r\n      await this.tts.speak(voice);\r\n      console.log(\"Successfully spoke\")\r\n    }\r\n    catch(e){\r\n      console.log(e)\r\n    }\r\n  }\r\n\r\n  listenForSpeech():void {\r\n    this.androidOptions = {\r\n        prompt: 'Speak into your phone!',\r\n        matches: 1\r\n    };\r\n\r\n    this.iosOptions = {\r\n        matches: 1\r\n    };\r\n\r\n    if(this.platform.is('android')){\r\n      this.speech.startListening(this.androidOptions).subscribe(\r\n        (data) => {\r\n          this.messages.push({\r\n            isHuman: true,\r\n            layout:'',\r\n            text: data,\r\n            time: new Date().toLocaleTimeString().replace(/:\\d+ /, ' ')\r\n          });\r\n          this.SendTextFromVoice(data)\r\n      }, (error) => {\r\n          console.log(error)\r\n      });\r\n    }\r\n    else if(this.platform.is('ios')){\r\n      this.speech.startListening(this.iosOptions).subscribe(data => this.speechList = data, error => console.log(error));\r\n      console.log(this.speechList);\r\n    }\r\n  }\r\n\r\n  async SendText(query):Promise<any> {\r\n    alert('enter in sendText');\r\n    try {\r\n        alert('a');\r\n        await ApiAIPlugin.requestText(\r\n          {\r\n            query,\r\n            originalRequest: {\r\n              source: 'WWT chat bot',\r\n              data: 'messages'\r\n            }\r\n          },\r\n           (response) => {\r\n             console.log(JSON.stringify(response))\r\n             console.log(JSON.stringify(response.result))\r\n             let speech = response.result.fulfillment;\r\n               if(response.result.fulfillment.speech){\r\n                alert(speech);\r\n                 if(this.platform.is('ios')){\r\n                    this.messages.push({\r\n                      isHuman: false,\r\n                      layout: '',\r\n                      text: speech,\r\n                      time: new Date().toLocaleTimeString().replace(/:\\d+ /, ' ')\r\n                    });\r\n                  this.ref.detectChanges();\r\n                } else {\r\n                  this.messages.push({\r\n                      isHuman: false,\r\n                      layout: '',\r\n                      text: speech,\r\n                      time: new Date().toLocaleTimeString().replace(/:\\d+ /, ' ')\r\n                    });\r\n                  this.ref.detectChanges();\r\n                }\r\n               } else {\r\n                 this.messages.push({\r\n                  isHuman: false,\r\n                  layout: '',\r\n                  text: \"I'm sorry. I could not find an answer to that request.\",\r\n                  time: new Date().toLocaleTimeString().replace(/:\\d+ /, ' ')\r\n                });\r\n                this.ref.detectChanges();\r\n               }\r\n            },\r\n            (error) => {\r\n                console.error(error);\r\n            });\r\n    } catch (e) {\r\n        alert(e);\r\n    }\r\n  }\r\n\r\n  async SendTextFromVoice(query):Promise<any> {\r\n    try {\r\n        await ApiAIPlugin.requestText(\r\n          {\r\n            query\r\n          },\r\n           (response) => {\r\n             if(response.result.fulfillment.speech){\r\n                let voice = response.result.fulfillment.speech\r\n                console.log('3', voice)\r\n                this.messages.push({\r\n                  isHuman: false,\r\n                  layout: '',\r\n                  text: voice,\r\n                  time: new Date().toLocaleTimeString().replace(/:\\d+ /, ' ')\r\n                });\r\n                this.ref.detectChanges();\r\n                this.SpeakText(voice)\r\n             } else {\r\n               let voice = \"I'm sorry. I could not find an answer to that request.\"\r\n                console.log('3', voice)\r\n                this.messages.push({\r\n                  isHuman: false,\r\n                  layout: response.result.fulfillment.data.layout,\r\n                  text: voice,\r\n                  time: new Date().toLocaleTimeString().replace(/:\\d+ /, ' ')\r\n                });\r\n                this.ref.detectChanges();\r\n                this.SpeakText(voice)\r\n             }\r\n            },\r\n            (error) => {\r\n                console.error(error);\r\n            });\r\n    } catch (e) {\r\n        alert(e);\r\n    }\r\n    }\r\n\r\n  async getSupportedLanguages():Promise<Array<string>> {\r\n    try{\r\n      const languages = await this.speech.getSupportedLanguages();\r\n      console.log(languages);\r\n      return languages;\r\n    }\r\n    catch(e){\r\n      console.error(e)\r\n    }\r\n  }\r\n\r\n  async hasPermission():Promise<boolean> {\r\n    try{\r\n      const permission = await this.speech.hasPermission();\r\n      console.log(permission)\r\n      return permission;\r\n    }\r\n    catch(e){\r\n      console.log(e)\r\n    }\r\n  }\r\n\r\n  async getPermission():Promise<void> {\r\n    try{\r\n      const permission = await this.speech.requestPermission();\r\n      console.log(permission)\r\n      return permission;\r\n    }\r\n    catch(e){\r\n      console.log(e)\r\n    }\r\n  }\r\n\r\n  async isSpeechSupported():Promise<boolean> {\r\n    const isAvailable = await this.speech.isRecognitionAvailable();\r\n    console.log(isAvailable)\r\n    return isAvailable;\r\n  }\r\n\r\n  async sendMessage():Promise<any> {\r\n\r\n    this.messages.push({\r\n      isHuman: true,\r\n      layout: '',\r\n      text: this.newMessage,\r\n      time: new Date().toLocaleTimeString().replace(/:\\d+ /, ' ')\r\n    });\r\n    alert(this.newMessage);\r\n    this.SendText(this.newMessage);\r\n\r\n    delete this.newMessage;\r\n  }\r\n\r\n  buildCardLayout(data) {\r\n      \r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat2/chat2.ts"],"sourceRoot":""}